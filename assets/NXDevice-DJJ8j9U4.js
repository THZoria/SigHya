import{j as e,m as p,A as v}from"./framer-motion-DORXFKSY.js";import{a as u}from"./react-vendor-n8-9m1E7.js";import{P as N}from"./PageTransition-CYfK23sm.js";import{u as w}from"./index-PykM2RrW.js";import{h as D,A as b,i as I,F as k,j as S}from"./lucide-icons-BL5jV39b.js";const j=async t=>{const a=new Uint8Array([78,105,110,116,101,110,100,111,78,88,67,65,49,80,114,111,100,49]),i=new Uint8Array([48,0,0,0]),s=await t.arrayBuffer(),n=new Uint8Array(s),r=n.length,m=y(n,a);if(m===-1)throw new Error("Start marker not found in file.");const x=y(n,i,m);if(x===-1)throw new Error("End marker not found in file.");const h=n.slice(m+a.length,x);let c=new TextDecoder("ascii").decode(h);c=c.replace(/-/g,"").trim(),c=c.replace(/^[^a-zA-Z0-9]+/,""),c=c.replace(/^NX/i,"");const f=Array.from(h).map(l=>l.toString(16).padStart(2,"0")).join(" ");return{fileSize:r,startIndex:m,endIndex:x,rawData:f,deviceId:c}},y=(t,a,i=0)=>{for(let s=i;s<=t.length-a.length;s++){let n=!0;for(let r=0;r<a.length;r++)if(t[s+r]!==a[r]){n=!1;break}if(n)return s}return-1},U=()=>{const{t}=w(),[,a]=u.useState(null),[i,s]=u.useState(null),[n,r]=u.useState(null),[m,x]=u.useState(!1),h=u.useRef(null),g=async l=>{const o=l.target.files?.[0];if(o){if(!o.name.toLowerCase().endsWith(".bin")){r(t("nxDevice.errors.invalidFormat")),a(null),s(null);return}a(o),r(null),s(null),x(!0);try{const d=await j(o);s(d)}catch(d){r(d instanceof Error?d.message:t("nxDevice.errors.analysisError"))}finally{x(!1)}}},c=l=>{l.preventDefault(),l.stopPropagation()},f=async l=>{l.preventDefault(),l.stopPropagation();const o=l.dataTransfer.files[0];if(o){if(!o.name.toLowerCase().endsWith(".bin")){r(t("nxDevice.errors.invalidFormat")),s(null);return}a(o),r(null),s(null),x(!0);try{const d=await j(o);s(d)}catch(d){r(d instanceof Error?d.message:t("nxDevice.errors.analysisError"))}finally{x(!1)}}};return e.jsx(N,{children:e.jsxs("div",{className:"min-h-screen pt-32 pb-16 relative",children:[e.jsx("div",{className:"absolute inset-0 bg-grid-pattern opacity-[0.03]"}),e.jsxs("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 relative",children:[e.jsxs(p.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},className:"text-center mb-12",children:[e.jsx("h1",{className:"text-5xl font-bold bg-gradient-to-r from-blue-400 to-blue-600 text-transparent bg-clip-text mb-4",children:t("nxDevice.title")}),e.jsx("p",{className:"text-xl text-blue-200/80",children:t("nxDevice.subtitle")}),e.jsxs("div",{className:"mt-4 bg-blue-500/10 border border-blue-500/20 rounded-lg p-4 text-sm text-blue-300",children:[e.jsxs("p",{children:["⚠️ ",t("nxDevice.warning.local")]}),e.jsx("p",{children:t("nxDevice.warning.noServer")})]})]}),e.jsxs(p.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},className:"bg-gray-800/80 backdrop-blur-sm rounded-2xl p-8 shadow-xl border border-blue-500/20 mb-8",children:[e.jsx("input",{type:"file",ref:h,onChange:g,accept:".bin",className:"hidden"}),e.jsx("div",{onClick:()=>h.current?.click(),onDragOver:c,onDrop:f,className:"border-2 border-dashed border-blue-500/30 rounded-xl p-8 text-center cursor-pointer transition-all hover:border-blue-500/50",children:e.jsxs("div",{className:"flex flex-col items-center gap-4",children:[e.jsx("div",{className:"p-4 bg-blue-500/10 rounded-full",children:e.jsx(D,{className:"w-8 h-8 text-blue-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-lg font-medium text-white mb-2",children:t("nxDevice.upload.title")}),e.jsx("p",{className:"text-sm text-gray-400",children:t("nxDevice.upload.subtitle")})]})]})})]}),e.jsxs(v,{mode:"wait",children:[m&&e.jsx(p.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"bg-blue-500/10 border border-blue-500/20 rounded-xl p-6 mb-8",children:e.jsxs("div",{className:"flex items-center justify-center gap-3",children:[e.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-2 border-blue-500 border-t-transparent"}),e.jsx("p",{className:"text-blue-400",children:t("nxDevice.processing")})]})}),n&&e.jsx(p.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"bg-red-500/10 border border-red-500/20 rounded-xl p-6 mb-8",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(b,{className:"w-5 h-5 text-red-400 flex-shrink-0"}),e.jsx("p",{className:"text-red-400",children:n})]})}),i&&e.jsxs(p.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"bg-green-500/10 border border-green-500/20 rounded-xl p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(I,{className:"w-5 h-5 text-green-400 flex-shrink-0"}),e.jsx("p",{className:"text-green-400",children:t("nxDevice.success")})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-gray-900/50 rounded-lg p-4",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-400 mb-2",children:t("nxDevice.fileInfo.deviceId")}),e.jsx("p",{className:"text-xl font-mono text-white text-center select-all",children:i.deviceId})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-gray-900/50 rounded-lg p-4",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-400 mb-2",children:t("nxDevice.fileInfo.fileSize")}),e.jsxs("p",{className:"text-lg text-white",children:[i.fileSize," octets"]})]}),e.jsxs("div",{className:"bg-gray-900/50 rounded-lg p-4",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-400 mb-2",children:t("nxDevice.fileInfo.markers")}),e.jsxs("p",{className:"text-lg text-white",children:[t("nxDevice.fileInfo.start"),": ",i.startIndex,e.jsx("br",{}),t("nxDevice.fileInfo.end"),": ",i.endIndex]})]})]}),e.jsxs("div",{className:"bg-gray-900/50 rounded-lg p-4",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-400 mb-2",children:t("nxDevice.fileInfo.rawData")}),e.jsx("p",{className:"text-sm font-mono text-white break-all",children:i.rawData})]})]})]})]}),e.jsxs(p.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.3,delay:.2},className:"mt-12 bg-gray-800/50 rounded-xl p-6 border border-gray-700",children:[e.jsx("h2",{className:"text-xl font-semibold text-white mb-4",children:t("nxDevice.instructions.title")}),e.jsxs("ul",{className:"space-y-2 text-gray-300",children:[e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx(k,{className:"w-5 h-5 text-blue-400 flex-shrink-0 mt-0.5"}),e.jsx("span",{children:t("nxDevice.instructions.selectFile")})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx(b,{className:"w-5 h-5 text-yellow-400 flex-shrink-0 mt-0.5"}),e.jsx("span",{children:t("nxDevice.instructions.format")})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx(S,{className:"w-5 h-5 text-red-400 flex-shrink-0 mt-0.5"}),e.jsx("span",{children:t("nxDevice.instructions.warning")})]})]})]})]})]})})};export{U as default};
